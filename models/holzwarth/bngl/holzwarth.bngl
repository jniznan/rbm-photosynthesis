begin model

begin parameters
	deex_flu     670e5  # de-excitation (fluorescence) 67000000
	deex_heat      2e5  # de-excitation (heat) 200000
	ch_re        50e10  # Charge recombination 500000000000
	ch_se        50e10  # Primary charge separation  500000000000
	stab_gen     25e10  # ChlD1+ reduction by P680 250000000000
	stab_re     6.7e10  # Reverse electron flow from ChlD1 to P680+  67000000000
	qa_red     0.48e10  # Qa reduction by PhD1-  4800000000
	qa_rev     0.24e10  # Reverse electron flow from Qa- to PhD1  2400000000
	extrans    1.92e10  # Energy transfer between A and ChlD1  k1  19200000000
	extrans2    2.5e10  # Energy transfer between A and ChlD1  k2  25000000000
end parameters

begin molecule types
	PSII(P680~n~p,Qa~n~m,PhD1~n~m,ac~n~exc,ChlD1~n~p~exc)
end molecule types

begin seed species
	PSII(P680~n,Qa~n,PhD1~n,ac~exc,ChlD1~n)           100
end seed species

begin reaction rules
	# Deexcitation - antenna:
	PSII(ac~exc) -> PSII(ac~n)   deex_flu
	PSII(ac~exc) -> PSII(ac~n)   deex_heat

	# Deexcitation - ChlD1:
	PSII(ChlD1~exc) -> PSII(ChlD1~n)   deex_flu
	PSII(ChlD1~exc) -> PSII(ChlD1~n)   deex_heat
	
	# Excitation Transfer:
	PSII(ac~exc,ChlD1~n) <-> PSII(ac~n,ChlD1~exc)   extrans, extrans2
	
	# Primary charge separation / recombination:
	PSII(PhD1~m,ChlD1~p) <-> PSII(PhD1~n,ChlD1~exc)    ch_re, ch_se
	
	# Stable pair generation:
	PSII(P680~n,PhD1~m,ChlD1~p) <-> PSII(P680~p,PhD1~m,ChlD1~n)   stab_gen, stab_re
	
	# Quinone Qa reduction:
	PSII(P680~p,Qa~n,PhD1~m) <-> PSII(P680~p,Qa~m,PhD1~n)    qa_red, qa_rev
end reaction rules

begin observables
	Molecules    Ant_exc              PSII(P680~n,Qa~n,PhD1~n,ac~exc,ChlD1~n) 
	Molecules    ChlD_exc            PSII(P680~n,Qa~n,PhD1~n,ac~n,ChlD1~exc) 
end observables

end model

## actions ##
# construct reaction network
generate_network({overwrite=>1})

#simulate({method=>ode,t_start=>1e-12,t_end=>1e-6,n_steps=>50000})
#simulate({method=>ode,sample_times=>[1.00000000000000e-13, 1.17095000000000e-13, 1.37113000000000e-13, 1.60553000000000e-13, 1.88000000000000e-13, 2.20139000000000e-13, 2.57772000000000e-13, 3.01839000000000e-13, 3.53439000000000e-13, 4.13860000000000e-13, 4.84611000000000e-13, 5.67456000000000e-13, 6.64464000000000e-13, 7.78056000000000e-13, 9.11067000000000e-13, 1.06682000000000e-12, 1.24919000000000e-12, 1.46274000000000e-12, 1.71280000000000e-12, 2.00561000000000e-12, 2.34848000000000e-12, 2.74995000000000e-12, 3.22007000000000e-12, 3.77055000000000e-12, 4.41513000000000e-12, 5.16991000000000e-12, 6.05372000000000e-12, 7.08862000000000e-12, 8.30043000000000e-12, 9.71941000000000e-12, 1.13810000000000e-11, 1.33266000000000e-11, 1.56048000000000e-11, 1.82725000000000e-11, 2.13962000000000e-11, 2.50539000000000e-11, 2.93370000000000e-11, 3.43522000000000e-11, 4.02248000000000e-11, 4.71013000000000e-11, 5.51534000000000e-11, 6.45820000000000e-11, 7.56225000000000e-11, 8.85504000000000e-11, 1.03688000000000e-10, 1.21414000000000e-10, 1.42170000000000e-10, 1.66474000000000e-10, 1.94934000000000e-10, 2.28258000000000e-10, 2.67279000000000e-10, 3.12972000000000e-10, 3.66475000000000e-10, 4.29125000000000e-10, 5.02485000000000e-10, 5.88386000000000e-10, 6.88972000000000e-10, 8.06753000000000e-10, 9.44670000000000e-10, 1.10616000000000e-09, 1.29527000000000e-09, 1.51669000000000e-09, 1.77598000000000e-09, 2.07958000000000e-09, 2.43510000000000e-09, 2.85138000000000e-09, 3.33883000000000e-09, 3.90961000000000e-09, 4.57797000000000e-09, 5.36059000000000e-09, 6.27700000000000e-09, 7.35006000000000e-09, 8.60658000000000e-09, 1.00779000000000e-08, 1.18007000000000e-08, 1.38181000000000e-08, 1.61803000000000e-08, 1.89464000000000e-08, 2.21854000000000e-08, 2.59780000000000e-08, 3.04190000000000e-08, 3.56192000000000e-08, 4.17084000000000e-08, 4.88386000000000e-08, 5.71876000000000e-08, 6.69640000000000e-08, 7.84117000000000e-08, 9.18164000000000e-08, 1.07513000000000e-07, 1.25892000000000e-07, 1.47414000000000e-07, 1.72615000000000e-07, 2.02123000000000e-07, 2.36677000000000e-07, 2.77138000000000e-07, 3.24515000000000e-07, 3.79992000000000e-07, 4.44952000000000e-07, 5.21018000000000e-07, 6.10087000000000e-07 ]})

# Same times as from e-photosynthesis
#simulate({method=>ssa,sample_times=>[1.00000000000000e-13, 1.17095000000000e-13, 1.37113000000000e-13, 1.60553000000000e-13, 1.88000000000000e-13, 2.20139000000000e-13, 2.57772000000000e-13, 3.01839000000000e-13, 3.53439000000000e-13, 4.13860000000000e-13, 4.84611000000000e-13, 5.67456000000000e-13, 6.64464000000000e-13, 7.78056000000000e-13, 9.11067000000000e-13, 1.06682000000000e-12, 1.24919000000000e-12, 1.46274000000000e-12, 1.71280000000000e-12, 2.00561000000000e-12, 2.34848000000000e-12, 2.74995000000000e-12, 3.22007000000000e-12, 3.77055000000000e-12, 4.41513000000000e-12, 5.16991000000000e-12, 6.05372000000000e-12, 7.08862000000000e-12, 8.30043000000000e-12, 9.71941000000000e-12, 1.13810000000000e-11, 1.33266000000000e-11, 1.56048000000000e-11, 1.82725000000000e-11, 2.13962000000000e-11, 2.50539000000000e-11, 2.93370000000000e-11, 3.43522000000000e-11, 4.02248000000000e-11, 4.71013000000000e-11, 5.51534000000000e-11, 6.45820000000000e-11, 7.56225000000000e-11, 8.85504000000000e-11, 1.03688000000000e-10, 1.21414000000000e-10, 1.42170000000000e-10, 1.66474000000000e-10, 1.94934000000000e-10, 2.28258000000000e-10, 2.67279000000000e-10, 3.12972000000000e-10, 3.66475000000000e-10, 4.29125000000000e-10, 5.02485000000000e-10, 5.88386000000000e-10, 6.88972000000000e-10, 8.06753000000000e-10, 9.44670000000000e-10, 1.10616000000000e-09, 1.29527000000000e-09, 1.51669000000000e-09, 1.77598000000000e-09, 2.07958000000000e-09, 2.43510000000000e-09, 2.85138000000000e-09, 3.33883000000000e-09, 3.90961000000000e-09, 4.57797000000000e-09, 5.36059000000000e-09, 6.27700000000000e-09, 7.35006000000000e-09, 8.60658000000000e-09, 1.00779000000000e-08, 1.18007000000000e-08, 1.38181000000000e-08, 1.61803000000000e-08, 1.89464000000000e-08, 2.21854000000000e-08, 2.59780000000000e-08, 3.04190000000000e-08, 3.56192000000000e-08, 4.17084000000000e-08, 4.88386000000000e-08, 5.71876000000000e-08, 6.69640000000000e-08, 7.84117000000000e-08, 9.18164000000000e-08, 1.07513000000000e-07, 1.25892000000000e-07, 1.47414000000000e-07, 1.72615000000000e-07, 2.02123000000000e-07, 2.36677000000000e-07, 2.77138000000000e-07, 3.24515000000000e-07, 3.79992000000000e-07, 4.44952000000000e-07, 5.21018000000000e-07, 6.10087000000000e-07 ]})
# 500 samples
simulate({method=>ssa,sample_times=>[1.00000000e-13,1.03760502e-13,1.07662418e-13,1.11711065e-13,1.15911962e-13,1.20270833e-13,1.24793621e-13,1.29486487e-13,1.34355829e-13,1.39408283e-13,1.44650734e-13,1.50090328e-13,1.55734477e-13,1.61590875e-13,1.67667503e-13,1.73972643e-13,1.80514888e-13,1.87303154e-13,1.94346693e-13,2.01655104e-13,2.09238348e-13,2.17106760e-13,2.25271064e-13,2.33742387e-13,2.42532274e-13,2.51652705e-13,2.61116110e-13,2.70935387e-13,2.81123917e-13,2.91695588e-13,3.02664806e-13,3.14046522e-13,3.25856248e-13,3.38110078e-13,3.50824714e-13,3.64017485e-13,3.77706369e-13,3.91910025e-13,4.06647809e-13,4.21939808e-13,4.37806863e-13,4.54270599e-13,4.71353453e-13,4.89078709e-13,5.07470524e-13,5.26553963e-13,5.46355035e-13,5.66900727e-13,5.88219040e-13,6.10339029e-13,6.33290840e-13,6.57105755e-13,6.81816229e-13,7.07455942e-13,7.34059837e-13,7.61664172e-13,7.90306568e-13,8.20026062e-13,8.50863158e-13,8.82859884e-13,9.16059848e-13,9.50508296e-13,9.86252179e-13,1.02334021e-12,1.06182294e-12,1.10175281e-12,1.14318425e-12,1.18617372e-12,1.23077980e-12,1.27706330e-12,1.32508729e-12,1.37491723e-12,1.42662102e-12,1.48026913e-12,1.53593468e-12,1.59369353e-12,1.65362441e-12,1.71580899e-12,1.78033202e-12,1.84728144e-12,1.91674849e-12,1.98882786e-12,2.06361777e-12,2.14122015e-12,2.22174078e-12,2.30528939e-12,2.39197984e-12,2.48193029e-12,2.57526333e-12,2.67210616e-12,2.77259076e-12,2.87685409e-12,2.98503825e-12,3.09729067e-12,3.21376434e-12,3.33461802e-12,3.46001639e-12,3.59013038e-12,3.72513730e-12,3.86522116e-12,4.01057288e-12,4.16139055e-12,4.31787973e-12,4.48025368e-12,4.64873371e-12,4.82354943e-12,5.00493910e-12,5.19314994e-12,5.38843844e-12,5.59107078e-12,5.80132310e-12,6.01948197e-12,6.24584471e-12,6.48071983e-12,6.72442742e-12,6.97729965e-12,7.23968114e-12,7.51192949e-12,7.79441575e-12,8.08752491e-12,8.39165644e-12,8.70722485e-12,9.03466021e-12,9.37440879e-12,9.72693362e-12,1.00927151e-11,1.04722519e-11,1.08660611e-11,1.12746796e-11,1.16986641e-11,1.21385926e-11,1.25950646e-11,1.30687023e-11,1.35601511e-11,1.40700809e-11,1.45991865e-11,1.51481892e-11,1.57178372e-11,1.63089068e-11,1.69222035e-11,1.75585633e-11,1.82188534e-11,1.89039738e-11,1.96148581e-11,2.03524752e-11,2.11178304e-11,2.19119669e-11,2.27359668e-11,2.35909533e-11,2.44780916e-11,2.53985907e-11,2.63537052e-11,2.73447368e-11,2.83730362e-11,2.94400048e-11,3.05470967e-11,3.16958209e-11,3.28877429e-11,3.41244871e-11,3.54077391e-11,3.67392478e-11,3.81208280e-11,3.95543624e-11,4.10418050e-11,4.25851829e-11,4.41865996e-11,4.58482375e-11,4.75723614e-11,4.93613210e-11,5.12175544e-11,5.31435916e-11,5.51420574e-11,5.72156756e-11,5.93672722e-11,6.15997796e-11,6.39162405e-11,6.63198120e-11,6.88137699e-11,7.14015130e-11,7.40865683e-11,7.68725952e-11,7.97633907e-11,8.27628946e-11,8.58751948e-11,8.91045332e-11,9.24553110e-11,9.59320948e-11,9.95396231e-11,1.03282813e-10,1.07166765e-10,1.11196773e-10,1.15378330e-10,1.19717134e-10,1.24219100e-10,1.28890361e-10,1.33737286e-10,1.38766479e-10,1.43984795e-10,1.49399346e-10,1.55017512e-10,1.60846948e-10,1.66895601e-10,1.73171713e-10,1.79683839e-10,1.86440853e-10,1.93451965e-10,2.00726730e-10,2.08275063e-10,2.16107251e-10,2.24233968e-10,2.32666291e-10,2.41415712e-10,2.50494154e-10,2.59913992e-10,2.69688063e-10,2.79829688e-10,2.90352688e-10,3.01271407e-10,3.12600724e-10,3.24356081e-10,3.36553498e-10,3.49209598e-10,3.62341632e-10,3.75967497e-10,3.90105762e-10,4.04775697e-10,4.19997295e-10,4.35791301e-10,4.52179242e-10,4.69183451e-10,4.86827104e-10,5.05134247e-10,5.24129830e-10,5.43839743e-10,5.64290847e-10,5.85511016e-10,6.07529169e-10,6.30375315e-10,6.54080591e-10,6.78677305e-10,7.04198979e-10,7.30680395e-10,7.58157646e-10,7.86668179e-10,8.16250851e-10,8.46945981e-10,8.78795401e-10,9.11842520e-10,9.46132376e-10,9.81711702e-10,1.01862899e-09,1.05693455e-09,1.09668060e-09,1.13792129e-09,1.18071285e-09,1.22511358e-09,1.27118400e-09,1.31898690e-09,1.36858742e-09,1.42005318e-09,1.47345431e-09,1.52886359e-09,1.58635653e-09,1.64601150e-09,1.70790980e-09,1.77213578e-09,1.83877698e-09,1.90792422e-09,1.97967175e-09,2.05411735e-09,2.13136247e-09,2.21151240e-09,2.29467637e-09,2.38096772e-09,2.47050406e-09,2.56340741e-09,2.65980440e-09,2.75982639e-09,2.86360972e-09,2.97129582e-09,3.08303146e-09,3.19896892e-09,3.31926620e-09,3.44408728e-09,3.57360225e-09,3.70798763e-09,3.84742658e-09,3.99210913e-09,4.14223247e-09,4.29800121e-09,4.45962763e-09,4.62733201e-09,4.80134292e-09,4.98189752e-09,5.16924187e-09,5.36363132e-09,5.56533078e-09,5.77461515e-09,5.99176967e-09,6.21709029e-09,6.45088409e-09,6.69346971e-09,6.94517777e-09,7.20635132e-09,7.47734631e-09,7.75853206e-09,8.05029181e-09,8.35302320e-09,8.66713880e-09,8.99306672e-09,9.33125118e-09,9.68215306e-09,1.00462506e-08,1.04240401e-08,1.08160363e-08,1.12227736e-08,1.16448062e-08,1.20827094e-08,1.25370799e-08,1.30085370e-08,1.34977233e-08,1.40053055e-08,1.45319752e-08,1.50784505e-08,1.56454759e-08,1.62338243e-08,1.68442976e-08,1.74777277e-08,1.81349780e-08,1.88169442e-08,1.95245558e-08,2.02587771e-08,2.10206088e-08,2.18110892e-08,2.26312957e-08,2.34823460e-08,2.43654001e-08,2.52816614e-08,2.62323788e-08,2.72188479e-08,2.82424133e-08,2.93044698e-08,3.04064649e-08,3.15499006e-08,3.27363353e-08,3.39673858e-08,3.52447300e-08,3.65701088e-08,3.79453285e-08,3.93722633e-08,4.08528580e-08,4.23891306e-08,4.39831747e-08,4.56371628e-08,4.73533492e-08,4.91340729e-08,5.09817606e-08,5.28989308e-08,5.48881961e-08,5.69522678e-08,5.90939590e-08,6.13161884e-08,6.36219849e-08,6.60144909e-08,6.84969672e-08,7.10727970e-08,7.37454909e-08,7.65186915e-08,7.93961785e-08,8.23818733e-08,8.54798453e-08,8.86943166e-08,9.20296681e-08,9.54904456e-08,9.90813657e-08,1.02807322e-07,1.06673394e-07,1.10684849e-07,1.14847155e-07,1.19165984e-07,1.23647224e-07,1.28296980e-07,1.33121590e-07,1.38127630e-07,1.43321923e-07,1.48711546e-07,1.54303847e-07,1.60106446e-07,1.66127252e-07,1.72374471e-07,1.78856616e-07,1.85582523e-07,1.92561357e-07,1.99802631e-07,2.07316213e-07,2.15112343e-07,2.23201647e-07,2.31595149e-07,2.40304289e-07,2.49340937e-07,2.58717408e-07,2.68446481e-07,2.78541416e-07,2.89015972e-07,2.99884423e-07,3.11161583e-07,3.22862820e-07,3.35004083e-07,3.47601918e-07,3.60673495e-07,3.74236629e-07,3.88309805e-07,4.02912203e-07,4.18063724e-07,4.33785019e-07,4.50097513e-07,4.67023439e-07,4.84585864e-07,5.02808725e-07,5.21716858e-07,5.41336030e-07,5.61692982e-07,5.82815458e-07,6.04732245e-07,6.27473213e-07,6.51069356e-07,6.75552832e-07,7.00957009e-07,7.27316511e-07,7.54667263e-07,7.83046540e-07,8.12493021e-07,8.43046837e-07,8.74749630e-07,9.07644607e-07,9.41776601e-07,9.77192128e-07,1.01393946e-06,1.05206867e-06,1.09163173e-06,1.13268257e-06,1.17527712e-06,1.21947344e-06,1.26533176e-06,1.31291459e-06,1.36228676e-06,1.41351558e-06,1.46667087e-06,1.52182505e-06,1.57905331e-06,1.63843365e-06,1.70004698e-06,1.76397728e-06,1.83031168e-06,1.89914058e-06,1.97055780e-06,2.04466067e-06,2.12155017e-06,2.20133111e-06,2.28411221e-06,2.37000629e-06,2.45913043e-06,2.55160607e-06,2.64755927e-06,2.74712079e-06,2.85042632e-06,2.95761666e-06,3.06883789e-06,3.18424160e-06,3.30398507e-06,3.42823149e-06,3.55715021e-06,3.69091691e-06,3.82971391e-06,3.97373038e-06,4.12316259e-06,4.27821420e-06,4.43909653e-06,4.60602884e-06,4.77923865e-06,4.95896201e-06,5.14544388e-06,5.33893840e-06,5.53970928e-06,5.74803016e-06,5.96418495e-06,6.18846824e-06,6.42118571e-06,6.66265452e-06,6.91320378e-06,7.17317494e-06,7.44292233e-06,7.72281357e-06,8.01323013e-06,8.31456781e-06,8.62723729e-06,8.95166472e-06,9.28829225e-06,9.63757866e-06,1.00000000e-05]})
